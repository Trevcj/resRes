<!DOCTYPE html>
<html>
<head>
	<title>Restaurant Reservation Node App</title>
	<link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
	<link href="https://fonts.googleapis.com/css?family=Lato|Sanchez" rel="stylesheet">
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
</head>
<body>
	<style type="text/css">
		
		.mainWrapper {
			display: grid;
			grid-template-rows: 65px auto 65px;
			width: 100%;
		}
			.nav {
				grid-row: 1/2;
				width: 100%;
				position: fixed;
				background-color: white;
			}
				#navText {
					display: block;
					font-size: 45px;
					text-align: center;
					margin: auto;
				}
			.mainBody {
				grid-row: 2/3;
				display: grid;
				width: 90%;
				margin: auto;
				margin-top: 65px;
				grid-template-columns: 30% 70%;
				grid-column-gap: 10px;
			}
				.sideNav {
					grid-column: 1/2;
					padding: 10px;
					border: solid #ccc 1px;
					border-radius: 5px;
				}
				.reservations {
					grid-column: 2/3;
					padding: 10px;
					border: solid #ccc 1px;
					border-radius: 5px;
					display: grid;
					grid-template-columns: 50% 50%;
					grid-template-rows: 10% 90%;
					grid-column-gap: 10px;
				}
					.top{
						grid-column: 1/3;
					}				
					.reserved {
						grid-column: 1/2;
						grid-row: 2/3;
						padding: 10px;
						
					}
					.waiting {
						grid-column: 2/3;
						grid-row: 2/3;
						padding: 10px;
						
					}
				#mainBodyText{
					font-size: 27px;
					text-align: center;
					text-decoration: underline;
				}
				#mainBodyTextSm {
					font-size: 20px;
					text-align: center;
					text-decoration: underline;
				}
			.footer {
				grid-row: 3/4;
				width: 100%;
				position: absolute;
			}

	</style>

	<div class="mainWrapper">
		<div class="nav">
			<p id="navText">The Closed Table</p>
		</div>
		
		<div class="mainBody">
			<div class="sideNav">
				<form>
				  <div class="form-group">
				    <label for="name">Name for the reservation</label>
				    <input type="text" class="form-control" id="name" placeholder="John Doe">
				  </div>
				  <div class="form-group">
				    <label for="resTime">Select a time</label>
				    <select class="form-control" id="resTime">
				      <option>0:00</option>
				      <option>5:00</option>
				      <option>5:15</option>
				      <option>6:45</option>
				      <option>7:00</option>
				      <option>7:30</option>
				    </select>
				  </div>
				  <div class="form-group">
				    <label for="phoneNum">Phone Number</label>
				    <input type="text" class="form-control" id="phoneNum" placeholder="555-555-5555">
				  </div>
				  <div class="form-group">
				    <label for="email">Email address</label>
				    <input type="email" class="form-control" id="email" placeholder="name@example.com">
				  </div>				  
				  <div class="form-group">
				    <label for="specialRequest">Special Request</label>
				    <textarea class="form-control" id="specialRequest" rows="3"></textarea>
				  </div>
				</form>
				<button type="submit" class="btn btn-primary" id="add-btn">Reserve Now</button>
			</div>
			<div class="reservations">
				<div class="top">
					<p id="mainBodyText">Reservations</p>
				</div>	
				<div class="reserved">
					<p id="mainBodyTextRes">Reserved</p>

				</div>
				<div class="waiting">
					<p id="mainBodyTextWait">Waiting List</p>
					
				</div>
			</div>
		</div>
		
		<div class="footer">
			
		</div>
	</div>
	<script type="text/javascript">
		
$.get("/data", function(data) {
      console.log(data);
      if(data.length<5){
	      for (var i = 0; i < data.length; i++) {
	        var wellSection = $("<div>");
	        wellSection.addClass("well");
	        wellSection.attr("id", "character-well-" + i);
	        $("#mainBodyTextRes").append(wellSection);

	        $("#character-well-" + i).append("<h2>Name:" + data[i].name + "</h2>");
	        $("#character-well-" + i).append("<h3>Time: " + data[i].time + "</h4>");
	        $("#character-well-" + i).append("<h3>Phone: " + data[i].phone + "</h4>");
	        $("#character-well-" + i).append("<h3>Email: " + data[i].email + "</h4>");
	        $("#character-well-" + i).append("<h3>Request: " + data[i].request + "</h4>");
	      }
	      
      }
      else{
          for (var i = 0; i < 5; i++) {
	        var wellSection = $("<div>");
	        wellSection.addClass("well");
	        wellSection.attr("id", "character-well-" + i);
	        $("#mainBodyTextRes").append(wellSection);

	        $("#character-well-" + i).append("<h2>" + data[i].name + "</h2>");
	        $("#character-well-" + i).append("<h3>Time: " + data[i].time + "</h4>");
	        $("#character-well-" + i).append("<h3>Phone: " + data[i].phone + "</h4>");
	        $("#character-well-" + i).append("<h3>Email: " + data[i].email + "</h4>");
	        $("#character-well-" + i).append("<h3>Request: " + data[i].request + "</h4>");
	      }
	      for (var i = 5; i < data.length; i++) {
	        var wellSection = $("<div>");
	        wellSection.addClass("well");
	        wellSection.attr("id", "character-well-" + i);
	        $("#mainBodyTextRes").append(wellSection);

	        $("#character-well-" + i).append("<h2>" + data[i].name + "</h2>");
	        $("#character-well-" + i).append("<h3>Time: " + data[i].time + "</h4>");
	        $("#character-well-" + i).append("<h3>Phone: " + data[i].phone + "</h4>");
	        $("#character-well-" + i).append("<h3>Email: " + data[i].email + "</h4>");
	        $("#character-well-" + i).append("<h3>Request: " + data[i].request + "</h4>");
	      }

      }
});

$("#add-btn").on("click", function(event) {
      event.preventDefault();

      var newRes = {
        name: $("#name").val().trim(),
        Time: $("#resTime").val().trim(),
        Phone: $("#phoneNum").val().trim(),
        Email: $("#email").val().trim(),
        Request: $("#specialRequest").val().trim(),
      };

      // Question: What does this code do??
      $.post("/api/new", newRes)
      .then(function(data) {
        console.log(data);
        if(data.length<5){
        alert("Adding you to Reservation...");
         for (var i = 0; i < 5; i++) {
	        var wellSection = $("<div>");
	        wellSection.addClass("well");
	        wellSection.attr("id", "character-well-" + i);
	        $("#mainBodyTextRes").append(wellSection);

	        $("#character-well-" + i).append("<h2>Name:" + data[i].name + "</h2>");
	        $("#character-well-" + i).append("<h3>Time: " + data[i].time + "</h4>");
	        $("#character-well-" + i).append("<h3>Phone: " + data[i].phone + "</h4>");
	        $("#character-well-" + i).append("<h3>Email: " + data[i].email + "</h4>");
	        $("#character-well-" + i).append("<h3>Request: " + data[i].request + "</h4>");
	      }


	    }else{
	    	 alert("Adding you to WaitList...");
            for (var i = 0; i < 5; i++) {
	        var wellSection = $("<div>");
	        wellSection.addClass("well");
	        wellSection.attr("id", "character-well-" + i);
	        $("#mainBodyTextRes").append(wellSection);

	        $("#character-well-" + i).append("<h2>" + data[i].name + "</h2>");
	        $("#character-well-" + i).append("<h3>Time: " + data[i].time + "</h4>");
	        $("#character-well-" + i).append("<h3>Phone: " + data[i].phone + "</h4>");
	        $("#character-well-" + i).append("<h3>Email: " + data[i].email + "</h4>");
	        $("#character-well-" + i).append("<h3>Request: " + data[i].request + "</h4>");
	      }
	      for (var i = 5; i < data.length; i++) {
	        var wellSection = $("<div>");
	        wellSection.addClass("well");
	        wellSection.attr("id", "character-well-" + i);
	        $("#mainBodyTextRes").append(wellSection);

	        $("#character-well-" + i).append("<h2>" + data[i].name + "</h2>");
	        $("#character-well-" + i).append("<h3>Time: " + data[i].time + "</h4>");
	        $("#character-well-" + i).append("<h3>Phone: " + data[i].phone + "</h4>");
	        $("#character-well-" + i).append("<h3>Email: " + data[i].email + "</h4>");
	        $("#character-well-" + i).append("<h3>Request: " + data[i].request + "</h4>");
	      }

	    }
      });
    

    });









	</script>
	

</body>
